!function(t){var e={};function n(i){if(e[i])return e[i].exports;var s=e[i]={i:i,l:!1,exports:{}};return t[i].call(s.exports,s,s.exports,n),s.l=!0,s.exports}n.m=t,n.c=e,n.d=function(t,e,i){n.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:i})},n.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var i=Object.create(null);if(n.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var s in t)n.d(i,s,function(e){return t[e]}.bind(null,s));return i},n.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(e,"a",e),e},n.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},n.p="",n(n.s=10)}([function(t,e){t.exports=Cesium},function(t,e){t.exports=function(){try{return echarts}catch(t){return{}}}()},function(t,e){t.exports=function(){try{return mapv}catch(t){return{}}}()},function(t,e){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(t){"object"==typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";(function(e){var n=setTimeout;function i(){}function s(t){if(!(this instanceof s))throw new TypeError("Promises must be constructed via new");if("function"!=typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(t,this)}function r(t,e){for(;3===t._state;)t=t._value;0!==t._state?(t._handled=!0,s._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null!==n){var i;try{i=n(t._value)}catch(t){return void a(e.promise,t)}o(e.promise,i)}else(1===t._state?o:a)(e.promise,t._value)})):t._deferreds.push(e)}function o(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"==typeof e||"function"==typeof e)){var n=e.then;if(e instanceof s)return t._state=3,t._value=e,void c(t);if("function"==typeof n)return void h((i=n,r=e,function(){i.apply(r,arguments)}),t)}t._state=1,t._value=e,c(t)}catch(e){a(t,e)}var i,r}function a(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&s._immediateFn(function(){t._handled||s._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)r(t,t._deferreds[e]);t._deferreds=null}function u(t,e,n){this.onFulfilled="function"==typeof t?t:null,this.onRejected="function"==typeof e?e:null,this.promise=n}function h(t,e){var n=!1;try{t(function(t){n||(n=!0,o(e,t))},function(t){n||(n=!0,a(e,t))})}catch(t){if(n)return;n=!0,a(e,t)}}s.prototype.catch=function(t){return this.then(null,t)},s.prototype.then=function(t,e){var n=new this.constructor(i);return r(this,new u(t,e,n)),n},s.prototype.finally=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})},s.all=function(t){return new s(function(e,n){if(!t||void 0===t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);var s=i.length;function r(t,o){try{if(o&&("object"==typeof o||"function"==typeof o)){var a=o.then;if("function"==typeof a)return void a.call(o,function(e){r(t,e)},n)}i[t]=o,0==--s&&e(i)}catch(t){n(t)}}for(var o=0;o<i.length;o++)r(o,i[o])})},s.resolve=function(t){return t&&"object"==typeof t&&t.constructor===s?t:new s(function(e){e(t)})},s.reject=function(t){return new s(function(e,n){n(t)})},s.race=function(t){return new s(function(e,n){for(var i=0,s=t.length;i<s;i++)t[i].then(e,n)})},s._immediateFn="function"==typeof e&&function(t){e(t)}||function(t){n(t,0)},s._unhandledRejectionFn=function(t){"undefined"!=typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)},t.exports=s}).call(this,n(6).setImmediate)},function(t,e,n){var i,s,r;s=[e,t],void 0===(r="function"==typeof(i=function(t,e){"use strict";var n={timeout:5e3,jsonpCallback:"callback",jsonpCallbackFunction:null};function i(t){try{delete window[t]}catch(e){window[t]=void 0}}function s(t){var e=document.getElementById(t);e&&document.getElementsByTagName("head")[0].removeChild(e)}e.exports=function(t){var e=arguments.length<=1||void 0===arguments[1]?{}:arguments[1],r=t,o=e.timeout||n.timeout,a=e.jsonpCallback||n.jsonpCallback,c=void 0;return new Promise(function(n,u){var h=e.jsonpCallbackFunction||"jsonp_"+Date.now()+"_"+Math.ceil(1e5*Math.random()),l=a+"_"+h;window[h]=function(t){n({ok:!0,json:function(){return Promise.resolve(t)}}),c&&clearTimeout(c),s(l),i(h)},r+=-1===r.indexOf("?")?"?":"&";var p=document.createElement("script");p.setAttribute("src",""+r+a+"="+h),e.charset&&p.setAttribute("charset",e.charset),p.id=l,document.getElementsByTagName("head")[0].appendChild(p),c=setTimeout(function(){u(new Error("JSONP request to "+t+" timed out")),i(h),s(l),window[h]=function(){i(h)}},o),p.onerror=function(){u(new Error("JSONP request to "+t+" failed")),i(h),s(l),c&&clearTimeout(c)}})}})?i.apply(e,s):i)||(t.exports=r)},function(t,e,n){(function(t){var i=void 0!==t&&t||"undefined"!=typeof self&&self||window,s=Function.prototype.apply;function r(t,e){this._id=t,this._clearFn=e}e.setTimeout=function(){return new r(s.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new r(s.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(7),e.setImmediate="undefined"!=typeof self&&self.setImmediate||void 0!==t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!=typeof self&&self.clearImmediate||void 0!==t&&t.clearImmediate||this&&this.clearImmediate}).call(this,n(3))},function(t,e,n){(function(t,e){!function(t,n){"use strict";if(!t.setImmediate){var i,s,r,o,a,c=1,u={},h=!1,l=t.document,p=Object.getPrototypeOf&&Object.getPrototypeOf(t);p=p&&p.setTimeout?p:t,"[object process]"==={}.toString.call(t.process)?i=function(t){e.nextTick(function(){f(t)})}:!function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?t.MessageChannel?((r=new MessageChannel).port1.onmessage=function(t){f(t.data)},i=function(t){r.port2.postMessage(t)}):l&&"onreadystatechange"in l.createElement("script")?(s=l.documentElement,i=function(t){var e=l.createElement("script");e.onreadystatechange=function(){f(t),e.onreadystatechange=null,s.removeChild(e),e=null},s.appendChild(e)}):i=function(t){setTimeout(f,0,t)}:(o="setImmediate$"+Math.random()+"$",a=function(e){e.source===t&&"string"==typeof e.data&&0===e.data.indexOf(o)&&f(+e.data.slice(o.length))},t.addEventListener?t.addEventListener("message",a,!1):t.attachEvent("onmessage",a),i=function(e){t.postMessage(o+e,"*")}),p.setImmediate=function(t){"function"!=typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var s={callback:t,args:e};return u[c]=s,i(c),c++},p.clearImmediate=d}function d(t){delete u[t]}function f(t){if(h)setTimeout(f,0,t);else{var e=u[t];if(e){h=!0;try{!function(t){var e=t.callback,i=t.args;switch(i.length){case 0:e();break;case 1:e(i[0]);break;case 2:e(i[0],i[1]);break;case 3:e(i[0],i[1],i[2]);break;default:e.apply(n,i)}}(e)}finally{d(t),h=!1}}}}}("undefined"==typeof self?void 0===t?this:t:self)}).call(this,n(3),n(8))},function(t,e){var n,i,s=t.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===r||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:r}catch(t){n=r}try{i="function"==typeof clearTimeout?clearTimeout:o}catch(t){i=o}}();var c,u=[],h=!1,l=-1;function p(){h&&c&&(h=!1,c.length?u=c.concat(u):l=-1,u.length&&d())}function d(){if(!h){var t=a(p);h=!0;for(var e=u.length;e;){for(c=u,u=[];++l<e;)c&&c[l].run();l=-1,e=u.length}c=null,h=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function m(){}s.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];u.push(new f(t,e)),1!==u.length||h||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},s.title="browser",s.browser=!0,s.env={},s.argv=[],s.version="",s.versions={},s.on=m,s.addListener=m,s.once=m,s.off=m,s.removeListener=m,s.removeAllListeners=m,s.emit=m,s.prependListener=m,s.prependOnceListener=m,s.listeners=function(t){return[]},s.binding=function(t){throw new Error("process.binding is not supported")},s.cwd=function(){return"/"},s.chdir=function(t){throw new Error("process.chdir is not supported")},s.umask=function(){return 0}},function(t,e,n){!function(e){"use strict";if(e.__disableNativeFetch||!e.fetch){a.prototype.append=function(t,e){t=r(t),e=o(e);var n=this.map[t];n||(n=[],this.map[t]=n),n.push(e)},a.prototype.delete=function(t){delete this.map[r(t)]},a.prototype.get=function(t){var e=this.map[r(t)];return e?e[0]:null},a.prototype.getAll=function(t){return this.map[r(t)]||[]},a.prototype.has=function(t){return this.map.hasOwnProperty(r(t))},a.prototype.set=function(t,e){this.map[r(t)]=[o(e)]},a.prototype.forEach=function(t,e){Object.getOwnPropertyNames(this.map).forEach(function(n){this.map[n].forEach(function(i){t.call(e,i,n,this)},this)},this)};var n={blob:"FileReader"in e&&"Blob"in e&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in e,arrayBuffer:"ArrayBuffer"in e},i=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];p.prototype.clone=function(){return new p(this)},l.call(p.prototype),l.call(m.prototype),m.prototype.clone=function(){return new m(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new a(this.headers),url:this.url})},m.error=function(){var t=new m(null,{status:0,statusText:""});return t.type="error",t};var s=[301,302,303,307,308];m.redirect=function(t,e){if(-1===s.indexOf(e))throw new RangeError("Invalid status code");return new m(null,{status:e,headers:{location:t}})},e.Headers=a,e.Request=p,e.Response=m,e.fetch=function(t,e){return new Promise(function(i,s){var r;r=p.prototype.isPrototypeOf(t)&&!e?t:new p(t,e);var o=new XMLHttpRequest;var a=!1;function c(){if(4===o.readyState){var t=1223===o.status?204:o.status;if(t<100||t>599){if(a)return;return a=!0,void s(new TypeError("Network request failed"))}var e={status:t,statusText:o.statusText,headers:f(o),url:"responseURL"in o?o.responseURL:/^X-Request-URL:/m.test(o.getAllResponseHeaders())?o.getResponseHeader("X-Request-URL"):void 0},n="response"in o?o.response:o.responseText;a||(a=!0,i(new m(n,e)))}}o.onreadystatechange=c,o.onload=c,o.onerror=function(){a||(a=!0,s(new TypeError("Network request failed")))},o.open(r.method,r.url,!0);try{"include"===r.credentials&&("withCredentials"in o?o.withCredentials=!0:console&&console.warn&&console.warn("withCredentials is not supported, you can ignore this warning"))}catch(t){console&&console.warn&&console.warn("set withCredentials error:"+t)}"responseType"in o&&n.blob&&(o.responseType="blob"),r.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send(void 0===r._bodyInit?null:r._bodyInit)})},e.fetch.polyfill=!0,t.exports&&(t.exports=e.fetch)}function r(t){if("string"!=typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function o(t){return"string"!=typeof t&&(t=String(t)),t}function a(t){this.map={},t instanceof a?t.forEach(function(t,e){this.append(e,t)},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function c(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function u(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function h(t){var e=new FileReader;return e.readAsArrayBuffer(t),u(e)}function l(){return this.bodyUsed=!1,this._initBody=function(t,e){if(this._bodyInit=t,"string"==typeof t)this._bodyText=t;else if(n.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t,this._options=e;else if(n.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(t){if(!n.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t))throw new Error("unsupported BodyInit type")}else this._bodyText=""},n.blob?(this.blob=function(){var t=c(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this.blob().then(h)},this.text=function(){var t,e,n,i,s,r,o,a=c(this);if(a)return a;if(this._bodyBlob)return t=this._bodyBlob,e=this._options,n=new FileReader,i=e.headers.map["content-type"]?e.headers.map["content-type"].toString():"",s=/charset\=[0-9a-zA-Z\-\_]*;?/,r=t.type.match(s)||i.match(s),o=[t],r&&o.push(r[0].replace(/^charset\=/,"").replace(/;$/,"")),n.readAsText.apply(n,o),u(n);if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)}):this.text=function(){var t=c(this);return t||Promise.resolve(this._bodyText)},n.formData&&(this.formData=function(){return this.text().then(d)}),this.json=function(){return this.text().then(JSON.parse)},this}function p(t,e){var n,s,r=(e=e||{}).body;if(p.prototype.isPrototypeOf(t)){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new a(t.headers)),this.method=t.method,this.mode=t.mode,r||(r=t._bodyInit,t.bodyUsed=!0)}else this.url=t;if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new a(e.headers)),this.method=(n=e.method||this.method||"GET",s=n.toUpperCase(),i.indexOf(s)>-1?s:n),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&r)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(r,e)}function d(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),i=n.shift().replace(/\+/g," "),s=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(i),decodeURIComponent(s))}}),e}function f(t){var e=new a;return t.getAllResponseHeaders().trim().split("\n").forEach(function(t){var n=t.trim().split(":"),i=n.shift().trim(),s=n.join(":").trim();e.append(i,s)}),e}function m(t,e){e||(e={}),this._initBody(t,e),this.type="default",this.status=e.status,this.ok=this.status>=200&&this.status<300,this.statusText=e.statusText,this.headers=e.headers instanceof a?e.headers:new a(e.headers),this.url=e.url||""}}("undefined"!=typeof self?self:this)},function(t,e,n){"use strict";n.r(e),window.CesiumZondy=window.CesiumZondy||{};var i=window.CesiumZondy||{};i.GeoSpark=i.GeoSpark||{},i.ElasticSearch=i.ElasticSearch||{},i.Overlayer=i.Overlayer||{};var s=n(2),r=n(0),o=n.n(r),a=s.baiduMapLayer?s.baiduMapLayer.__proto__:Function;class c extends a{constructor(t,e,n,i){if(super(t,e,n),a){this.map=t,this.scene=t.scene,this.dataSet=e;n=n||{},this.init(n),this.argCheck(n),this.initDevicePixelRatio(),this.canvasLayer=i,this.stopAniamation=!1,this.animation=n.animation,this.clickEvent=this.clickEvent.bind(this),this.mousemoveEvent=this.mousemoveEvent.bind(this),this.bindEvent()}}initDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio||1}clickEvent(t){var e=t.point;super.clickEvent(e,t)}mousemoveEvent(t){var e=t.point;super.mousemoveEvent(e,t)}addAnimatorEvent(){}animatorMovestartEvent(){var t=this.options.animation;this.isEnabledTime()&&this.animator&&(this.steps.step=t.stepsRange.start)}animatorMoveendEvent(){this.isEnabledTime()&&this.animator}bindEvent(){this.map;this.options.methods&&(this.options.methods.click,this.options.methods.mousemove)}unbindEvent(){var t=this.map;this.options.methods&&(this.options.methods.click&&t.off("click",this.clickEvent),this.options.methods.mousemove&&t.off("mousemove",this.mousemoveEvent))}getContext(){return this.canvasLayer.canvas.getContext(this.context)}init(t){this.options=t,this.initDataRange(t),this.context=this.options.context||"2d",this.options.zIndex&&this.canvasLayer&&this.canvasLayer.setZIndex(this.options.zIndex),this.initAnimator()}_canvasUpdate(t){this.map;var e=this.scene;if(this.canvasLayer&&!this.stopAniamation){var n=this.options.animation,i=this.getContext();if(this.isEnabledTime()){if(void 0===t)return void this.clear(i);"2d"===this.context&&(i.save(),i.globalCompositeOperation="destination-out",i.fillStyle="rgba(0, 0, 0, .1)",i.fillRect(0,0,i.canvas.width,i.canvas.height),i.restore())}else this.clear(i);if("2d"===this.context)for(var r in this.options)i[r]=this.options[r];else i.clear(i.COLOR_BUFFER_BIT);var a={transferCoordinate:function(t){var n=o.a.Cartesian3.fromDegrees(t[0],t[1]),i=o.a.SceneTransforms.wgs84ToWindowCoordinates(e,n);return null==i?[-1,-1]:[i.x,i.y]}};void 0!==t&&(a.filter=function(e){var i=n.trails||10;return!!(t&&e.time>t-i&&e.time<t)});var c=this.dataSet.get(a);this.processData(c),"m"==this.options.unit&&this.options.size,this.options._size=this.options.size;var u=o.a.SceneTransforms.wgs84ToWindowCoordinates(e,o.a.Cartesian3.fromDegrees(0,0));this.drawContext(i,new s.DataSet(c),this.options,u),this.options.updateCallback&&this.options.updateCallback(t)}}updateData(t,e){var n=t;n&&n.get&&(n=n.get()),null!=n&&this.dataSet.set(n),super.update({options:e})}addData(t,e){var n=t;t&&t.get&&(n=t.get()),this.dataSet.add(n),this.update({options:e})}getData(){return this.dataSet}removeData(t){if(this.dataSet){var e=this.dataSet.get({filter:function(e){return null==t||"function"!=typeof t||!t(e)}});this.dataSet.set(e),this.update({options:null})}}clearData(){this.dataSet&&this.dataSet.clear(),this.update({options:null})}draw(){this.canvasLayer.draw()}clear(t){t&&t.clearRect&&t.clearRect(0,0,t.canvas.width,t.canvas.height)}}var u=0;class h{constructor(t,e,n,i){this.map=t,this.scene=t.scene,this.mapvBaseLayer=new c(t,e,n,this),this.mapVOptions=n,this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.render=this.render.bind(this),null!=i?(this.container=i,i.appendChild(this.canvas)):(this.container=t.container,this.addInnerContainer()),this.bindEvent(),this._reset()}initDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio||1}addInnerContainer(){this.container.appendChild(this.canvas)}bindEvent(){this.map;this.innerMoveStart=this.moveStartEvent.bind(this),this.innerMoveEnd=this.moveEndEvent.bind(this),this.innnerZoomStart=this.zoomStartEvent.bind(this),this.innnerZoomEnd=this.zoomEndEvent.bind(this);var t=new o.a.ScreenSpaceEventHandler(this.scene.canvas);t.setInputAction(this.innerMoveEnd,o.a.ScreenSpaceEventType.WHEEL),t.setInputAction(this.innerMoveStart,o.a.ScreenSpaceEventType.LEFT_DOWN),t.setInputAction(this.innerMoveEnd,o.a.ScreenSpaceEventType.LEFT_UP),t.setInputAction(this.innerMoveStart,o.a.ScreenSpaceEventType.RIGHT_DOWN),t.setInputAction(this.innerMoveEnd,o.a.ScreenSpaceEventType.RIGHT_UP)}unbindEvent(){this.map}moveStartEvent(){this.mapvBaseLayer&&this.mapvBaseLayer.animatorMovestartEvent(),this._unvisiable()}moveEndEvent(){this.mapvBaseLayer&&this.mapvBaseLayer.animatorMoveendEvent(),this._reset(),this._visiable()}zoomStartEvent(){this._unvisiable()}zoomEndEvent(){this._unvisiable()}addData(t,e){null!=this.mapvBaseLayer&&this.mapvBaseLayer.addData(t,e)}updateData(t,e){null!=this.mapvBaseLayer&&this.mapvBaseLayer.updateData(t,e)}getData(){return this.mapvBaseLayer&&(this.dataSet=this.mapvBaseLayer.getData()),this.dataSet}removeData(t){null!=this.mapvBaseLayer&&this.mapvBaseLayer&&this.mapvBaseLayer.removeData(t)}removeAllData(){null!=this.mapvBaseLayer&&this.mapvBaseLayer.clearData()}_visiable(){return this.canvas.style.display="block",this}_unvisiable(){return this.canvas.style.display="none",this}_createCanvas(){var t=document.createElement("canvas");t.id=this.mapVOptions.layerid||"mapv"+u++,t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.mapVOptions.zIndex||100,t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height;var e=this.devicePixelRatio;return"2d"==this.mapVOptions.context&&t.getContext(this.mapVOptions.context).scale(e,e),t}_reset(){this.resizeCanvas(),this.fixPosition(),this.onResize(),this.render()}draw(){this._reset()}show(){this._visiable()}hide(){this._unvisiable()}destroy(){this.remove()}remove(){null!=this.mapvBaseLayer&&(this.removeAllData(),this.mapvBaseLayer.clear(this.mapvBaseLayer.getContext()),this.mapvBaseLayer=void 0,this.canvas.parentElement.removeChild(this.canvas))}update(t){null!=t&&this.updateData(t.data,t.options)}resizeCanvas(){if(null!=this.canvas&&null!=this.canvas){var t=this.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height}}fixPosition(){}onResize(){}render(){null!=this.mapvBaseLayer&&this.mapvBaseLayer._canvasUpdate()}}i.Overlayer.MapvLayer=h;var l=n(1),p=n.n(l);function d(t,e){this._CesiumMap=t,this._CesiumScene=t.scene,this.dimensions=["lng","lat"],this._mapOffset=[0,0],this._mapViewRect,this._api=e}d.prototype.dimensions=["lng","lat"],d.prototype.setMapOffset=function(t){this._mapOffset=t},d.prototype.getBMap=function(){return this._CesiumMap},d.prototype.dataToPoint=function(t){var e=o.a.Cartesian3.fromDegrees(t[0],t[1]),n=this._CesiumMap.camera.position,i=this._CesiumMap.scene.globe.ellipsoid.cartesianToCartographic(n).height;if(i+=1.2*this._CesiumMap.scene.globe.ellipsoid.maximumRadius,o.a.Cartesian3.distance(n,e)>i)return[-50,-50];var s=this._mapOffset,r=(n=o.a.Cartesian3.fromDegrees(t[0],t[1]),o.a.SceneTransforms.wgs84ToWindowCoordinates(this._CesiumScene,n));return[r.x-s[0],r.y-s[1]]},d.prototype.pointToData=function(t){var e=this._mapOffset,n=o.a.Cartesian3.fromDegrees(t[0]+e[0],t[1]+e[1]),i=o.a.SceneTransforms.wgs84ToWindowCoordinates(this._CesiumScene,n);return[i.x,i.y]},d.prototype.getViewRect=function(){var t=this._api;return new p.a.graphic.BoundingRect(0,0,t.getWidth(),t.getHeight())},d.prototype.getRoamTransform=function(){return p.a.matrix.create()},d.prototype.prepareCustoms=function(t){var e=p.a.util,n=this.getViewRect();return{coordSys:{type:"cesium",x:n.x,y:n.y,width:n.width,height:n.height},api:{coord:e.bind(this.dataToPoint,this),size:e.bind(function(t,n){return n=n||[0,0],e.map([0,1],function(e){var i=n[e],s=t[e]/2,r=[],o=[];return r[e]=i-s,o[e]=i+s,r[1-e]=o[1-e]=n[1-e],Math.abs(this.dataToPoint(r)[e]-this.dataToPoint(o)[e])},this)},this)}}},d.dimensions=d.prototype.dimensions,d.create=function(t,e){var n;t.eachComponent("cesium",function(t){e.getZr().painter.getViewportRoot();var i=p.a.cesiumMap;(n=new d(i,e)).setMapOffset(t.__mapOffset||[0,0]),t.coordinateSystem=n}),t.eachSeries(function(t){"cesium"===t.get("coordinateSystem")&&(t.coordinateSystem=n)})};var f=0;class m{constructor(t,e,n){return this.map=t,this.scene=t.scene,this.options=e,this.initStats=!1,this.layerId=e.layerId||"echarts"+f++,this.layerClass=e.layerClass||"echartlayerdefaultclass",this.initDevicePixelRatio(),this.canvas=this._createCanvas(),this.container=t.container,this.addInnerContainer(),this.chart=p.a.init(this.canvas),this.initEcharts(),this._resizeCanvas(),this.resize(),this}initDevicePixelRatio(){this.devicePixelRatio=window.devicePixelRatio||1}addInnerContainer(){this.container.appendChild(this.canvas)}initEcharts(){return p.a.cesiumMap=this.map,p.a.registerCoordinateSystem("cesium",d),p.a.extendComponentModel({type:"cesium",getBMap:function(){return this.__cesium},defaultOption:{roam:!1}}),p.a.registerAction({type:"CesiumRoma",event:"CesiumRoma",update:"updateLayout"},function(t,e){}),this}_createCanvas(){var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.pointerEvents="none",t.style.zIndex=this.options.zIndex||100;var e=parseInt(this.map.canvas.width)+"px",n=parseInt(this.map.canvas.height)+"px";return t.width=e,t.height=n,t.style.width=e,t.style.height=n,t}_resizeCanvas(){const t=this;window.onresize=function(){var e=t.canvas,n=t.map;e.style.position="absolute",e.style.top="0px",e.style.left="0px";var i=parseInt(n.canvas.width)+"px",s=parseInt(n.canvas.height)+"px";e.width=i,e.height=s,e.style.width=i,e.style.height=s,t.chart.resize()}}_visible(){this.canvas.style.visibility="visible"}_unvisible(){this.canvas.style.visibility="hidden"}addTo(t){var e=this;return p.a.extendComponentView({type:"cesium",render:function(t,n,i){var s=!0,r=(p.a.cesiumMap,i.getZr().painter.getViewportRoot()),a=t.coordinateSystem,c=function(n,o){if(!s){e._unvisible();var c=e.map.canvas,u=[-parseInt(c.style.left,10)||0,-parseInt(c.style.top,10)||0];r.style.left=u[0]+"px",r.style.top=u[1]+"px",a.setMapOffset(u),t.__mapOffset=u,i.dispatchAction({type:"CesiumRoma"})}},u=function(n,o){if(!s){var c=e.map.canvas,u=[-parseInt(c.style.left,10)||0,-parseInt(c.style.top,10)||0];r.style.left=u[0]+"px",r.style.top=u[1]+"px",a.setMapOffset(u),t.__mapOffset=u,i.dispatchAction({type:"CesiumRoma"}),e._visible()}};var h=new o.a.ScreenSpaceEventHandler(e.scene.canvas);0==e.initStats&&(e.initStats=!0,h.setInputAction(function(){e._unvisible(),s||i.dispatchAction({type:"CesiumRoma"})},o.a.ScreenSpaceEventType.WHEEL),h.setInputAction(c,o.a.ScreenSpaceEventType.LEFT_DOWN),h.setInputAction(u,o.a.ScreenSpaceEventType.LEFT_UP),h.setInputAction(c,o.a.ScreenSpaceEventType.RIGHT_DOWN),h.setInputAction(u,o.a.ScreenSpaceEventType.RIGHT_UP)),this._oldMoveHandler=c,this._oldZoomEndHandler=function(){s||i.dispatchAction({type:"CesiumRoma"})};t.get("roam");s=!1}}),this.chart.setOption(this.options),this}show(){this._visible()}hide(){this._unvisible()}resize(){if(null!=this.canvas&&null!=this.canvas){var t=this.canvas;t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.width=parseInt(this.map.canvas.width),t.height=parseInt(this.map.canvas.height),t.style.width=this.map.canvas.style.width,t.style.height=this.map.canvas.style.height}}remove(){return this.chart.clear(),this.canvas.parentElement&&this.canvas.parentElement.removeChild(this.canvas),this.map=void 0,this}}i.Overlayer.EchartsLayer=m;var v=window.Zondy=window.Zondy||{};v.Util=v.Util||{},v.Network=v.Network||{},v.Event=v.Event||{},v.Socket=v.Socket||{},v.GeoSpark=v.GeoSpark||{};const y="http://",w=":",g="pgsql/tableInfoAsJson?";var b=n(4),E=n.n(b);window.Promise=E.a;n(9);var _=n(5),T=n.n(_),S=(v.Util=v.Util||{},function(t,e){var n=t;if(e){var i=(t+" ").split(/[?&]/);n+=" "===i.pop()?e:i.length?"&"+e:"?"+e}return n});Object.create||function(){function t(){}}();Array.isArray;function x(t){return window["webkit"+t]||window["moz"+t]||window["ms"+t]}var C=0;function O(t){var e=+new Date,n=Math.max(0,16-(e-C));return C=e+n,window.setTimeout(t,n)}window.requestAnimationFrame||x("RequestAnimationFrame"),window.cancelAnimationFrame||x("CancelAnimationFrame")||x("CancelRequestAnimationFrame");v.Util.extend=function(t,e){if(t=t||{},e){for(var n in e){var i=e[n];void 0!==i&&(t[n]=i)}!("function"==typeof window.Event&&e instanceof window.Event)&&e.hasOwnProperty&&e.hasOwnProperty("toString")&&(t.toString=e.toString)}return t},v.Util.appendUrl=S,v.Util.endsWith=function(t,e){return-1!==t.indexOf(e,t.length-e.length)},v.Util.extendFromArray=function(t,e){for(const n of e)for(const e in n)t[e]=n[e];return t};const I=window.fetch;var L=v.CORS=v.CORS||window.XMLHttpRequest&&"withCredentials"in new window.XMLHttpRequest,R=v.DefaultTimeout=v.DefaultTimeout||6e4,P=v.FetchRequest={commit:function(t,e,n,i){switch(t=t?t.toUpperCase():t){case"GET":return this.get(e,n,i);case"POST":return this.post(e,n,i);case"PUT":return this.put(e,n,i);case"DELETE":return this.delete(e,n,i);default:return this.get(e,n,i)}},get:function(t,e,n){n=n||{};return t=this.prefixUrl(t,n),t=S(t,this.getParamString(e||{})),this.urlIsLong(t)?this.postSimulate("GET",t.substring(0,t.indexOf("?")-1),e,n):this.fetchByES(t,e,n,"GET")},delete:function(t,e,n){n=n||{};return t=this.prefixUrl(t,n),t=S(t,this.getParamString(e||{})),!this.urlIsLong(t)&&L?this.fetchByES(t,e,n,"DELETE"):this.postSimulate("DELETE",t.substring(0,t.indexOf("?")-1),e,n)},post:function(t,e,n){return n=n||{},this.fetchByES(this.prefixUrl(t,n),e,n,"POST")},put:function(t,e,n){return n=n||{},this.fetchByES(this.prefixUrl(t,n),e,n,"PUT")},urlIsLong:function(t){for(var e=0,n=null,i=0,s=t.length;i<s;i++)(n=t.charCodeAt(i))<127?e++:128<=n&&n<=2047?e+=2:2048<=n&&n<=65535&&(e+=3);return!(e<2e3)},postSimulate:function(t,e,n,i){var s=e.indexOf("?")>-1?"&":"?";return e+=s+"_method="+t,"string"!=typeof n&&(n=JSON.stringify(n)),this.post(e,n,i)},prefixUrl:function(t,e){return e&&e.proxy&&("function"==typeof e.proxy?t=e.proxy(t):(t=decodeURIComponent(t),t=e.proxy+encodeURIComponent(t))),t},fetchByES:function(t,e,n,i){return(n=n||{}).headers=n.headers||{},n.headers["Content-Type"]||(n.headers["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8"),n.timeout?this.timeDelay(n.timeout,I(t,{method:i,headers:n.headers,body:"PUT"===i||"POST"===i?e:void 0,credentials:n.withCredentials?"include":"omit",mode:"cors",timeout:R}).then(function(t){return t})):I(t,{method:i,body:"PUT"===i||"POST"===i?e:void 0,headers:n.headers,credentials:n.withCredentials?"include":"omit",mode:"cors",timeout:R}).then(function(t){return t})},fetchByJsonp:function(t,e){return e=e||{},T()(t,{method:"GET",timeout:e.timeout}).then(function(t){return t})},timeDelay:function(t,e){return new Promise(function(n,i){setTimeout(function(){i(new Error("timeout"))},t),e.then(n,i)})},getParamString:function(t){var e=[];for(var n in t){var i=t[n];if(null!=i&&"function"!=typeof i){var s;if("object"==typeof i&&i.constructor===Array){for(var r,o=[],a=0,c=i.length;a<c;a++)r=i[a],o.push(encodeURIComponent(null==r?"":r));s="["+o.join(",")+"]"}else s=encodeURIComponent(i);e.push(encodeURIComponent(n)+"="+s)}}return e.join("&")}};v.Network.FetchRequest=P,v.Network.CORS=L,v.Network.DefaultTimeout=R,v.Service=v.Service||{};class D{constructor(t,e,n,i,s,r,o){this.method=t,this.url=e,this.params=n,this.fetchServiceData(i,s,r,o)}fetchServiceData(t,e,n,i){P.commit(this.method,this.url,this.params,{}).then(function(t){return t.text?t.text():t.json()}).then(function(s){var r=null;"string"!=typeof s||"true"!=s.toLowerCase()&&"false"!=s.toLowerCase()?"string"==typeof s&&(r=s):(r={},"true"==s.toLowerCase()?r.succeed=!0:r.error=!0),r&&!r.error||(r=r&&r.error?{error:r.error}:{error:!0}),r.error?i(r):(isNaN(r)||(r={value:r}),"string"==typeof r&&(r={value:r}),"[object Array]"!=Object.prototype.toString.call(r)?r.succeed=null==r.succeed||r.succeed:r={value:r,succeed:!0},n(r,t,e))})}}v.Service.IServiceQuery=D;v.GeoSpark.TimeSpaceCubeService=void 0;class A{constructor(t,e,n){this.urlAddress="",this.queryOption={},this.handleSuccess=e,this.handleFailure=n,this.prefixUrlPost(t.ip,t.socket,t.queryOption),new D("GET",this.urlAddress,this.queryOption,this.map,this.handleSuccess,this.handleFailure)}prefixUrlPost(t,e,n){this.urlAddress="http://192.168.81.223:9091/pgsql/tableInfoAsJson?libName=postgis&tableName=createspacetimecube_zhc_001&schemas=public&includeProps=true",this.urlAddress=""+y+t+w+e+"/"+g,this.queryOption=n}}v.GeoSpark.TimeSpaceCubeService=A,i.GeoSpark.TimeSpaceCubeLayer=void 0;class B{constructor(t,e,n){this.layer=null,this.styleOptions=t.styleOption,this.successCallback=e,this.failureCallback=n,new A(t,this.onLoadSuccess,this.onLoadFailure)}onLoadSuccess(t,e,n){var i=[],s=t.features;null!=s&&null!=s&&(s.forEach(function(t){var s=t.properties.cubeindex,r=JSON.parse(s),a=(r.maxX+r.minX)/2,c=(r.maxY+r.minY)/2,u=new o.a.Entity({name:r.location[0]+"-"+r.location[1]+"-"+r.location[2],position:o.a.Cartesian3.fromDegrees(a,c,n.height),box:{dimensions:new o.a.Cartesian3(n.x,n.y,n.z),material:o.a.Color.RED.withAlpha(.5),outline:!0,outlineColor:o.a.Color.BLACK}});e.entities.add(u),i.push(u)}),this.successCallback(i))}onLoadFailure(){}}B.successCallback=void 0,B.failureCallback=void 0;i.GeoSpark.TimeSpaceCubeLayer=function(t,e,n,i,s){return new B(t,e,n,i,s)};const k="http://",M=":",U=":",F=",",j=";",q="polygon",G="stGeoHashQueryByAgg",z="0";v.ElasticSearch=v.ElasticSearch||{};class H{constructor(t,e,n,i,s,r,o,a){this.method=t,this.url=e,this.params=n,this.fetchServiceData(s,i,r,o,a)}fetchServiceData(t,e,n,i,s){P.commit(this.method,this.url,this.params,{}).then(function(t){return t.json()}).then(function(i){n(i,t,e,s)})}}v.ElasticSearch.IServiceLoadData=H,i.ElasticSearch.GeoHashLayer=void 0;class N{constructor(t,e,n,i,s,r){this.layer=null,this.map=n,this.urlAddress="",this.queryOption={},this.styleOption=s,this.onCallback=r,this.prefixUrlPost(t,e,i),new H("GET",this.urlAddress,this.queryOption,this.styleOption,this.map,this.onSuccess,this.onFailure,this.onCallback)}prefixUrlPost(t,e,n){this.urlAddress=""+k+t+M+e+"/es/"+G,this.queryOption.indexName=n.db,this.queryOption.typeName=n.table,n&&n.space&&(this.queryOption.aggfield=n.space.field,this.queryOption.spatialCondition=q+U+n.space.north+F+n.space.west+j+n.space.north+F+n.space.east+j+n.space.south+F+n.space.east+j+n.space.south+F+n.space.west),n&&n.time&&(this.queryOption.timefield=n.time.field,this.queryOption.timeCondition=""+n.time.starttime+F+n.time.endtime,this.startTime=n.time.starttime,this.endTime=n.time.endtime),this.queryOption.aggGeoFormat=z,this.queryOption.percision=n.space.percision}onSuccess(t,e,n,r){var o=[],a=t.features;null!=a&&null!=a&&(a.forEach(function(t){o.push({geometry:{type:"Point",coordinates:t.geometry.coordinates},count:t.properties.aggcount})}),o=new s.DataSet(o),null==i.ElasticSearch.GeoHashLayer?i.ElasticSearch.GeoHashLayer=new h(e,o,n):i.ElasticSearch.GeoHashLayer.updateData(o,n),null!=r&&null!=r&&r(t))}onFailure(){}}i.ElasticSearch.GeoHashService=function(t,e,n,i,s,r){return new N(t,e,n,i,s,r)},n.d(e,"CesiumZondy",function(){return i}),n.d(e,"MapvLayer",function(){return h}),n.d(e,"EchartsLayer",function(){return m}),n.d(e,"MapvBaseLayer",function(){return c}),n.d(e,"MapCoordSys",function(){return d}),n.d(e,"TimeSpaceCubeLayer",function(){return B}),n.d(e,"GeoHashService",function(){return N})}]);